# ğŸ“¦ æ‰¹é‡ä¸Šä¼ å·¥å…·ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

è¿™ä¸ªå·¥å…·ç”¨äºå°†å¤§é‡ FDA æ–‡æ¡£æ‰¹é‡ä¸Šä¼ åˆ° Supabaseï¼Œæ”¯æŒï¼š
- âœ… è‡ªåŠ¨æ‰«æç›®å½•
- âœ… å¹¶å‘ä¸Šä¼ ï¼ˆå¯é…ç½®ï¼‰
- âœ… è‡ªåŠ¨æ–‡æœ¬æå–ï¼ˆPDF, TXTï¼‰
- âœ… è‡ªåŠ¨åˆ†ç±»å’Œæ ‡ç­¾
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•
- âœ… è¯¦ç»†çš„ä¸Šä¼ æŠ¥å‘Š

## å‰ç½®è¦æ±‚

1. **Node.js ç¯å¢ƒ**ï¼šç¡®ä¿å·²å®‰è£… Node.js 18+
2. **ç¯å¢ƒå˜é‡**ï¼šé…ç½® `.env.local` æ–‡ä»¶
3. **æ–‡æ¡£å‡†å¤‡**ï¼šå°† FDA æ–‡æ¡£æ”¾åœ¨æŒ‡å®šç›®å½•

## å®‰è£…ä¾èµ–

```bash
# å¦‚æœè¿˜æ²¡æœ‰å®‰è£…ä¾èµ–
npm install
```

## é…ç½®ç¯å¢ƒå˜é‡

ç¡®ä¿ `.env.local` æ–‡ä»¶åŒ…å«ä»¥ä¸‹å˜é‡ï¼š

```bash
NEXT_PUBLIC_SUPABASE_URL=https://zzilbkehuxvbajupambt.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
```

## å‡†å¤‡æ–‡æ¡£

1. åˆ›å»ºæºæ–‡æ¡£ç›®å½•ï¼š
```bash
mkdir fda-documents
```

2. å°† FDA æ–‡æ¡£æ”¾å…¥è¯¥ç›®å½•ï¼ˆæ”¯æŒå­ç›®å½•ï¼‰ï¼š
```
fda-documents/
â”œâ”€â”€ 2024/
â”‚   â”œâ”€â”€ warning-letter-001.pdf
â”‚   â”œâ”€â”€ approval-notice-002.pdf
â”‚   â””â”€â”€ ...
â”œâ”€â”€ 2023/
â”‚   â””â”€â”€ ...
â””â”€â”€ guidance/
    â””â”€â”€ ...
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆæºç›®å½•: ./fda-documents, å¹¶å‘æ•°: 10ï¼‰
node scripts/bulk-upload.js
```

### è‡ªå®šä¹‰é…ç½®

```bash
# æŒ‡å®šæºç›®å½•
SOURCE_DIR=./my-documents node scripts/bulk-upload.js

# æŒ‡å®šå¹¶å‘æ•°ï¼ˆå»ºè®® 5-20ï¼‰
CONCURRENCY=20 node scripts/bulk-upload.js

# ç»„åˆä½¿ç”¨
SOURCE_DIR=./fda-documents CONCURRENCY=15 node scripts/bulk-upload.js
```

### ä½¿ç”¨ npm scripts

åœ¨ `package.json` ä¸­æ·»åŠ ï¼š

```json
{
  "scripts": {
    "bulk-upload": "node scripts/bulk-upload.js",
    "bulk-upload:test": "SOURCE_DIR=./test-documents CONCURRENCY=5 node scripts/bulk-upload.js"
  }
}
```

ç„¶åè¿è¡Œï¼š

```bash
npm run bulk-upload
```

## æ”¯æŒçš„æ–‡ä»¶ç±»å‹

- âœ… PDF (`.pdf`) - è‡ªåŠ¨æå–æ–‡æœ¬
- âœ… çº¯æ–‡æœ¬ (`.txt`) - ç›´æ¥è¯»å–
- â³ Word æ–‡æ¡£ (`.doc`, `.docx`) - å¾…å®ç°

## è¾“å‡ºç¤ºä¾‹

```
ğŸš€ å¼€å§‹æ‰¹é‡ä¸Šä¼  FDA æ–‡æ¡£...

ğŸ“ æºç›®å½•: ./fda-documents
âš¡ å¹¶å‘æ•°: 10
ğŸ“„ æ”¯æŒçš„æ–‡ä»¶ç±»å‹: .pdf, .doc, .docx, .txt

ğŸ” æ‰«ææ–‡ä»¶...
âœ… æ‰¾åˆ° 10523 ä¸ªæ–‡ä»¶

ğŸ“¤ å¼€å§‹ä¸Šä¼ ...

âœ… [1/10523] Uploaded: warning-letter-001.pdf
âœ… [2/10523] Uploaded: approval-notice-002.pdf
âœ… [3/10523] Uploaded: guidance-document-003.pdf
...
âŒ [15] Failed: corrupted-file.pdf - Invalid PDF structure
...

============================================================
ğŸ“Š æ‰¹é‡ä¸Šä¼ æŠ¥å‘Š
============================================================
æ€»æ–‡ä»¶æ•°: 10523
æˆåŠŸä¸Šä¼ : 10508 (99.86%)
ä¸Šä¼ å¤±è´¥: 15
è·³è¿‡æ–‡ä»¶: 0
æ€»è€—æ—¶: 3245.67 ç§’
å¹³å‡é€Ÿåº¦: 3.24 æ–‡ä»¶/ç§’

âŒ é”™è¯¯åˆ—è¡¨:
1. corrupted-file.pdf: Invalid PDF structure
2. large-file.pdf: File size exceeds limit
...
============================================================
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å¹¶å‘æ•°è®¾ç½®

| æ–‡æ¡£æ•°é‡ | æ¨èå¹¶å‘æ•° | é¢„è®¡æ—¶é—´ |
|---------|-----------|---------|
| < 100 | 5 | å‡ åˆ†é’Ÿ |
| 100-1000 | 10 | 10-30 åˆ†é’Ÿ |
| 1000-10000 | 15-20 | 1-3 å°æ—¶ |
| > 10000 | 20-30 | 3-8 å°æ—¶ |

### æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œç¨³å®šæ€§**ï¼šç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®š
2. **Supabase é™åˆ¶**ï¼š
   - å…è´¹è®¡åˆ’ï¼š1GB Storage, 500MB Database
   - Pro è®¡åˆ’ï¼š100GB Storage, 8GB Database
3. **æ–‡ä»¶å¤§å°é™åˆ¶**ï¼šå•ä¸ªæ–‡ä»¶æœ€å¤§ 50MB
4. **API é€Ÿç‡é™åˆ¶**ï¼šé¿å…å¹¶å‘æ•°è¿‡é«˜

## æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼šç¯å¢ƒå˜é‡æœªå®šä¹‰

```
âŒ é”™è¯¯: ç¼ºå°‘ Supabase ç¯å¢ƒå˜é‡
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `.env.local` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
2. ç¡®è®¤ç¯å¢ƒå˜é‡åç§°æ­£ç¡®
3. é‡æ–°åŠ è½½ç¯å¢ƒå˜é‡

### é—®é¢˜ 2ï¼šæºç›®å½•ä¸å­˜åœ¨

```
âŒ é”™è¯¯: æºç›®å½•ä¸å­˜åœ¨: ./fda-documents
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. åˆ›å»ºç›®å½•ï¼š`mkdir fda-documents`
2. æˆ–æŒ‡å®šæ­£ç¡®çš„ç›®å½•ï¼š`SOURCE_DIR=./your-directory node scripts/bulk-upload.js`

### é—®é¢˜ 3ï¼šä¸Šä¼ å¤±è´¥

```
âŒ Failed: document.pdf - Storage quota exceeded
```

**å¯èƒ½åŸå› **ï¼š
- Storage ç©ºé—´ä¸è¶³
- æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶
- ç½‘ç»œè¿æ¥ä¸­æ–­
- æ–‡ä»¶æŸå

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ Supabase Storage ä½¿ç”¨æƒ…å†µ
2. å‡çº§ Supabase è®¡åˆ’
3. æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§
4. é‡æ–°è¿è¡Œè„šæœ¬ï¼ˆä¼šè‡ªåŠ¨è·³è¿‡å·²ä¸Šä¼ çš„æ–‡ä»¶ï¼‰

### é—®é¢˜ 4ï¼šæ–‡æœ¬æå–å¤±è´¥

```
Failed to extract text from document.pdf: Invalid PDF structure
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ–‡ä»¶ä¼šè¢«ä¸Šä¼ ï¼Œä½† `content_text` å­—æ®µä¸ºç©º
- å¯ä»¥åç»­æ‰‹åŠ¨å¤„ç†æˆ–ä½¿ç”¨å…¶ä»–å·¥å…·æå–

## é«˜çº§åŠŸèƒ½

### æ–­ç‚¹ç»­ä¼ 

è„šæœ¬ä¼šè‡ªåŠ¨è·³è¿‡å·²ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆåŸºäºæ–‡ä»¶åå’Œæ—¶é—´æˆ³ï¼‰ã€‚å¦‚æœä¸Šä¼ ä¸­æ–­ï¼Œå¯ä»¥ç›´æ¥é‡æ–°è¿è¡Œè„šæœ¬ã€‚

### è‡ªå®šä¹‰åˆ†ç±»å’Œæ ‡ç­¾

ç¼–è¾‘ `bulk-upload.js` ä¸­çš„ `inferCategory()` å’Œ `inferTags()` å‡½æ•°æ¥è‡ªå®šä¹‰åˆ†ç±»é€»è¾‘ï¼š

```javascript
function inferCategory(fileName) {
  const lowerName = fileName.toLowerCase();
  
  // æ·»åŠ ä½ çš„åˆ†ç±»é€»è¾‘
  if (lowerName.includes('your-keyword')) {
    return 'Your Category';
  }
  
  return 'General';
}
```

### æ‰¹é‡ç”Ÿæˆå‘é‡åµŒå…¥

åœ¨ä¸Šä¼ å®Œæˆåï¼Œå¯ä»¥è¿è¡Œå‘é‡åµŒå…¥ç”Ÿæˆè„šæœ¬ï¼ˆå¾…å¼€å‘ï¼‰ï¼š

```bash
node scripts/generate-embeddings.js
```

## ä¸‹ä¸€æ­¥

ä¸Šä¼ å®Œæˆåï¼Œä½ å¯ä»¥ï¼š

1. âœ… åœ¨ Supabase Dashboard ä¸­éªŒè¯æ•°æ®
2. âœ… æµ‹è¯•æœç´¢åŠŸèƒ½
3. âœ… é…ç½®ç”¨æˆ·è®¤è¯å’Œæƒé™
4. âœ… éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Supabase Dashboard çš„ Storage å’Œ Database çŠ¶æ€
2. æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
3. è„šæœ¬è¾“å‡ºçš„é”™è¯¯æ—¥å¿—

---

**æç¤º**ï¼šé¦–æ¬¡ä½¿ç”¨å»ºè®®å…ˆç”¨å°‘é‡æ–‡æ¡£ï¼ˆ10-20 ä»½ï¼‰æµ‹è¯•ï¼Œç¡®è®¤ä¸€åˆ‡æ­£å¸¸åå†è¿›è¡Œå¤§è§„æ¨¡ä¸Šä¼ ã€‚

